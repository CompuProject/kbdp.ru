var timerHide=!1;showToggles=function(){new DG.OnOffSwitchAuto({cls:".block-item.active .custom-switch",textOn:"",height:33,heightTrack:16,textOff:"",trackColorOff:"f5f5f5",listener:function(t,e){var s=$("input[name="+t+"]").closest(".values").length;if(e?$("input[name="+t+"]").val("Y"):$("input[name="+t+"]").val("N"),s){var a,i=$('<div class="btn-ajax-block animation-opacity"></div>'),o=$("input[name="+t+"]").closest(".option-wrapper"),n=BX.pos(o[0],!0),c=$("input[name="+t+"]").closest(".inner-wrapper").data("key"),l=t.replace(c+"_","");i.html($(".values > .apply-block").html()),o.toggleClass("disabled"),a=n.top+$(".style-switcher .header").actual("outerHeight"),i.css("top",a),$(".btn-ajax-block").length&&$(".btn-ajax-block").remove(),i.appendTo($(".style-switcher")),i.addClass("opacity1"),e?("INSTAGRAMM_INDEX"==l&&($(".instagram_ajax .instagram").length||($(".instagram_ajax").removeClass("loaded"),$.ajax({type:"POST",url:arAllcorp2Options.SITE_DIR+"include/mainpage/comp_instagramm.php",data:{SHOW_INSTAGRAM:"Y",AJAX_REQUEST_INSTAGRAM:"Y"},success:function(t){$(".instagram_ajax").html(t)}}))),$(".drag-block[data-class="+l+"_drag]").removeClass("hidden"),$(".templates_block .item."+t).removeClass("hidden"),InitFlexSlider(),$(window).resize(),"BIG_BANNER_INDEX"==l&&$(".long-banner").length&&$("body").addClass("header_opacity")):($(".drag-block[data-class="+l+"_drag]").addClass("hidden"),$(".templates_block .item."+t).addClass("hidden"),"BIG_BANNER_INDEX"==l&&$(".long-banner").length&&$("body").removeClass("header_opacity")),$.post(arAllcorp2Options.SITE_DIR+"ajax/options_save_mainpage.php",{VALUE:$("input[name="+t+"]").val(),NAME:t})}setTimeout(function(){s||$("form[name=style-switcher]").submit()},200)}})},$(document).ready(function(){$(".style-switcher .item input[type=checkbox]").on("change",function(){var t=$(this);t.is(":checked")?t.val("Y"):t.val("N"),$("form[name=style-switcher]").submit()}),showToggles(),$(".style-switcher .can_save .save_btn").on("click",function(){var e=$(this);timerHide&&(clearTimeout(timerHide),timerHide=!1),$.ajax({type:"POST",url:arAllcorp2Options.SITE_DIR+"ajax/options_save.php",data:{SAVE_OPTIONS:"Y"},dataType:"json",success:function(t){"STATUS"in t&&($(".save_config_status").length||$('<div class="save_config_status"><span></span></div>').appendTo(e.parent()),"OK"===t.STATUS?$(".save_config_status").addClass("success"):$(".save_config_status").addClass("error"),$(".save_config_status span").text(BX.message(t.MESSAGE)),$(".save_config_status").slideDown(200),timerHide=setTimeout(function(){$(".save_config_status").slideUp(200,function(){$(this).remove()})},1e3))}})}),$(".refresh-block.sup-params .values .inner-wrapper").each(function(){var i=$(this),t=i[0];Sortable.create(t,{handle:".drag",animation:150,forceFallback:!0,filter:".no_drag",onStart:function(t){t.oldIndex,window.getSelection().removeAllRanges()},onMove:function(t){return-1===t.related.className.indexOf("no_drag")},onUpdate:function(t){t.item;var e=[],s=i.data("key"),a="SORT_ORDER_INDEX_TYPE_"+s;i.find(".option-wrapper").each(function(){e.push($(this).find('input[type="checkbox"]').attr("name").replace(s+"_","")),$('div[data-class="'+$(this).find('input[type="checkbox"]').attr("name").replace(s+"_","")+'_drag"]').attr("data-order",$(this).index()+1)}),$("input[name="+a+"]").val(e.join(",")),$.post(arAllcorp2Options.SITE_DIR+"ajax/options_save_mainpage.php",{VALUE:e.join(","),NAME:a})}})}),"open"==$.cookie("styleSwitcher")&&$(".style-switcher").addClass("active"),$(".base_color_custom input[type=hidden]").length&&$(".base_color_custom input[type=hidden]").each(function(){var t=$(this),s=$(this).closest(".base_color_custom");t.spectrum({preferredFormat:"hex",showButtons:!0,showInput:!0,showPalette:!1,appendTo:s,chooseText:BX.message("CUSTOM_COLOR_CHOOSE"),cancelText:BX.message("CUSTOM_COLOR_CANCEL"),containerClassName:"custom_picker_container",replacerClassName:"custom_picker_replacer",clickoutFiresChange:!1,move:function(t){var e=t.toHexString();s.find("span span").attr("style","background:"+e)},hide:function(t){var e=t.toHexString();s.find("span span").attr("style","background:"+e)},change:function(t){s.addClass("current").siblings().removeClass("current"),$("form[name=style-switcher] input[name="+s.find(".click_block").data("option-id")+"]").val(s.find(".click_block").data("option-value")),$("form[name=style-switcher]").submit()}})}),$(".base_color_custom").click(function(t){return t.preventDefault(),$("input[name="+$(this).data("name")+"]").spectrum("toggle"),!1}),$(".base_color.current").length&&$(".base_color.current").each(function(){var t=$(this).closest(".options").find(".base_color_custom"),e=$(this).data("color");null!=e&&e.length&&($("input[name="+t.data("name")+"]").spectrum("set",e),t.find("span span").attr("style","background:"+e))}),$(".style-switcher .switch").click(function(t){t.preventDefault();var e=$(this).closest(".style-switcher");HideHintBlock(),e.hasClass("active")?(e.addClass("closes"),setTimeout(function(){e.removeClass("active")},500),$.removeCookie("styleSwitcher",{path:"/"})):(ShowOverlay(),e.removeClass("closes").addClass("active"),$.cookie("styleSwitcher","open",{path:"/"}))}),$("html, body").on("mousedown",function(t){"string"==typeof t.target.className&&t.target.className.indexOf("adm")<0&&(t.stopPropagation(),!$(t.target).closest(".style-switcher").length&&$(".style-switcher").hasClass("active")&&$(".style-switcher .switch").trigger("click"))}),$(".style-switcher .tooltip-link").on("show.bs.tooltip",function(){$(this).closest(".item").siblings().find(".tooltip").remove()}),HideHintBlock=function(){HideOverlay(),$.cookie("clickedSwitcher","Y",{path:"/"}),$(".style-switcher .tooltip.in").length&&$(".style-switcher .tooltip.in").fadeIn(300,function(){$(".style-switcher .tooltip.in").remove()})},$(document).on("click",".close-overlay",function(){HideHintBlock()}),$(document).on("click",".jqmOverlay",function(){var t=$(".style-switcher");$(".hint-theme").length||HideOverlay(),t.each(function(){var t=$(this);t.addClass("closes"),setTimeout(function(){t.removeClass("active")},500),$(".form_demo-switcher").animate({left:"-"+$(".form_demo-switcher").outerWidth()+"px"},100).removeClass("active abs")}),$.removeCookie("styleSwitcher",{path:"/"})}),$(".style-switcher .section-block").on("click",function(){$(this).siblings().removeClass("active"),$(this).addClass("active"),$(".style-switcher .right-block .block-item").removeClass("active"),$(".style-switcher .right-block .block-item:eq("+$(this).index()+")").addClass("active"),$.cookie("styleSwitcherTabIndex",$(this).index(),{path:"/"}),$(this).hasClass("toggle_initied")||showToggles(),$(this).addClass("toggle_initied")}),$(".style-switcher .reset").click(function(t){$("form[name=style-switcher]").append('<input type="hidden" name="THEME" value="default" />'),$("form[name=style-switcher]").submit()}),$(document).on("click",".style-switcher .apply",function(){$("form[name=style-switcher]").submit()}),$(".style-switcher .sup-params.options .block-title").click(function(){$(this).next().slideToggle()}),$(".style-switcher .options > a,.style-switcher .options > div:not(.base_color_custom) a, .style-switcher .options > div:not(.base_color_custom) .click_block").click(function(t){var e=$(this);if(!e.hasClass("current")&&!e.hasClass("disabled"))if(e.addClass("current").siblings().removeClass("current"),$("form[name=style-switcher] input[name="+e.data("option-id")+"]").val(e.data("option-value")),void 0!==$(this).data("option-type")&&$.cookie("scoll_block",$(this).data("option-type")),void 0!==$(this).data("option-url")&&$("form[name=style-switcher]").prepend('<input type="hidden" name="backurl" value='+$(this).data("option-url")+" />"),e.closest(".options").hasClass("refresh-block")){if(!e.closest(".options").hasClass("sup-params"))e.index();e.closest(".item").find(".sup-params.options").removeClass("active"),e.closest(".item").find(".sup-params.options.s_"+e.data("option-value")).addClass("active"),$("form[name=style-switcher]").submit()}else $("form[name=style-switcher]").submit()}),$(".tooltip-link").on("shown.bs.tooltip",function(t){var e=$(this).next(),s=($(window).height(),$(this).closest("form").scrollTop(),BX.pos($(this)[0],!0)),a=BX.pos(e[0],!0),i=BX.pos($(this).closest(".item")[0],!0);!$(this).closest(".item").next().length&&a.bottom>i.bottom&&(e.removeClass("bottom").addClass("top"),e.css({top:s.top-e.actual("outerHeight")}))})});